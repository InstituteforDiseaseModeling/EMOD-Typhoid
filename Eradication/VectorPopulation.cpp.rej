--- VectorPopulation.cpp
+++ VectorPopulation.cpp
@@ -134,10 +134,11 @@
         }
 
         // Create a larval habitat for each type specified in configuration file for this species
-        for( int ihabitat = 0; ihabitat < species()->habitat_type.size(); ihabitat++ )
+        //for( int ihabitat = 0; ihabitat < species()->habitat_params.habitat_map.size(); ihabitat++ )
+        for( auto habitat_param : species()->habitat_params.habitat_map )
         {
-            VectorHabitatType::Enum type = species()->habitat_type[ihabitat];
-            float max_larval_capacity = species()->habitat_param[ihabitat] * params()->x_templarvalhabitat * ivnc->GetLarvalHabitatMultiplier(type);
+            VectorHabitatType::Enum type = habitat_param.first;
+            float max_larval_capacity = habitat_param.second * params()->x_templarvalhabitat * ivnc->GetLarvalHabitatMultiplier(type);
             VectorHabitat* habitat = nullptr;
 
 #if 0
@@ -612,7 +613,7 @@
 
         // now adjust population and eggs
         if (dead_mosquitoes > 0) { queue->SetPopulation( queue->GetPopulation() - dead_mosquitoes); }
-        unsigned long int tempeggs = unsigned long(species()->eggbatchsize * x_infectedeggbatchmod * (successful_human_feed + successful_AD_feed * ADfeed_eggbatchmod + successful_animal_feed * animalfeed_eggbatchmod));
+        unsigned long int tempeggs = (unsigned long)(species()->eggbatchsize * x_infectedeggbatchmod * (successful_human_feed + successful_AD_feed * ADfeed_eggbatchmod + successful_animal_feed * animalfeed_eggbatchmod));
         neweggs += tempeggs;
         gender_mating_eggs[queue->GetVectorGenetics().GetIndex()] += tempeggs;
         LOG_DEBUG_F("adding %d eggs to vector genetics index %d.  current total=%d\n", tempeggs, queue->GetVectorGenetics().GetIndex(), gender_mating_eggs[queue->GetVectorGenetics().GetIndex()]);
